# python malware

- **tags**: #python #malware #attacks 
- **sources**: 
	- https://www.cyborgsecurity.com/python-malware-on-the-rise
---

- [[attacks]]
	- threat actors tend to distribute their malware effectively by converting their [[python]] code into an executable format
	- malware could be placed on a target effectively “featureless” and capabilities could be executed on the target on an as-needed basis to remain stealthy

- methods
	- some [[tools]] used to create a stand-alone Linux [[ELF executables]] and linkable format (similar to .EXE in windows):
		-  **pyinstaller** 
			- still requires Python interpreter inside executable
			- outputted file is much larger than the original (drawback)
		- **py2exe**
			- still requires Python interpreter inside executable
			- not been supported past Python 3.4
			- utilizes `distutils` and requires a `setup.py` script
			- outputted file is much larger than the original (drawback)
		- **nuitka**
			- translates Python code into a C program, linked against `libpython` to execute code like `CPython`
			- can use C compilers like gcc, clang, MinGW64, Visual Studio 2019+, and clang-cl
			- outputted file is a **fraction** of the size of PyInstaller or py2exe
			- translating the Python code to C it is much more difficult to [[reverse engineer]]

- examples
	- simple examples:
		- obfuscation
			- pyminifier and pyarmor
		- screenshots
			- pyscreenshot and python-mss
		- web requests
		- `eval()` - definitely dangerous with no restrictions on string execution
	- [[in the wild]]
		- **SeaDuke**
			- Democratic National Committee (DNC) was compromised (_supposedly_) by two threat actor groups (APT 28 & 29)
			- python trojan + pyinstaller packed with UPX
		- **PWOBot**
			- makes use of [[tor]] tunneling traffic to remote hosts
			- uses a python dictionary as it's network protocol, frequently [[phoning home]]
		- **PyLocky**
			- included anti-sandbox capabilities, c2, and encryption (w/3DES)
		- **pupy and Stitch**
			- feature rich, cross-platform, all-in-memory execution guidelines, low footprint, C2 encryption methods, migrate processes via [[reflective injection]], and can load remote python code from memory

- analysis tools
	- **uncompyle6** - native cross-version decompiler and fragment decompiler
	- **pyinstxtractor.py** - can extract Python data from PyInstaller compiled executables

- detection
	- likely [[YARA]] rules can detect compiled executables
	- 